"0","# generate_drcs <- function(data.df,tax.distance){"
"0","#   model.1 <- drm(percent_val~dose,data=data.df %>% filter(taxonomic.distance <=tax.distance), "
"0","#               fct=LL.2())"
"0","#   return(model.1)"
"0","# } "
"0",""
"0","# "
"0","# #"
"0","# #Generate plots "
"0","# plot_drc_model <- function(plot_data){"
"0","#   "
"0","#   ggplot(plot_data$pred)+geom_line(aes(x=dose,y=response))+scale_x_log10()+"
"0","#     geom_point(data=plot_data$origData,aes(x=dose,y=percent_val,color=genus))+"
"0","#     ggtitle(plot_data$origData$chemical_name, plot_data$origData$test_cas)"
"0","# }"
"0","# "
"0","# #Generate plots "
"0","# get_plot_dataframe <- function(model){"
"0","#   #make a dataframe for plotting"
"0","#   n_points = 100 "
"0","#   data.df <- model$data"
"0","#   orig.data.df <- model$origData"
"0","#   min_x = data.df$dose %>% min()"
"0","#   max_x = data.df$dose %>% max()"
"0","#   doses = seq(log(min_x),log(max_x), length.out = n_points) %>% exp()"
"0","#   pred <- data.frame(dose = doses) %>% "
"0","#     mutate(response = predict(model,x))"
"0","#   "
"0","#   ll <- list("
"0","#     predictions = pred, "
"0","#     origData = orig.data.df"
"0","#   )"
"0","#   "
"0","# return(ll)"
"0","# }"
